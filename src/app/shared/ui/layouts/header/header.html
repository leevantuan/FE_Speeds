<header
  class="sticky top-0 z-50 flex items-center justify-between gap-3 rounded-2xl border border-primary bg-surface backdrop-blur-xl px-4 py-3 shadow-xl"
>
  <!-- Left -->
  <div class="flex items-center gap-3 min-w-0">
    <button
      class="lg:hidden grid h-11 w-11 place-items-center rounded-xl border border-soft bg-surface hover:bg-surface-2"
      (click)="openSidebarOnMobile.emit()"
      aria-label="Open sidebar"
    >
      ‚ò∞
    </button>

    <div class="min-w-0">
      <div class="text-lg font-semibold text-main leading-tight truncate">Permission Context</div>
      <div class="text-xs text-subtle truncate">Senior Manager ‚Ä¢ North America Sales</div>
    </div>
  </div>

  <!-- Middle: search -->
  <div class="hidden md:flex flex-1 justify-center px-4">
    <div
      class="flex w-full max-w-[520px] items-center gap-2 rounded-2xl border border-soft bg-surface px-3 py-2 hover-border-primary focus-within:border-primary"
    >
      <span class="text-faint">üîé</span>

      <input
        class="w-full bg-transparent outline-none text-sm text-main placeholder:text-faint"
        placeholder="Search modules..."
      />

      <span class="text-xs rounded-full border border-soft bg-surface-2 px-2 py-0.5 text-faint">
        ‚åòK
      </span>
    </div>
  </div>

  <!-- Right -->
  <div class="flex items-center gap-2">
    <button
      class="grid h-11 w-11 place-items-center rounded-xl border border-soft bg-surface hover:bg-surface-2"
      title="Settings"
      aria-label="Settings"
    >
      ‚öôÔ∏è
    </button>

    <button
      class="grid h-11 w-11 place-items-center rounded-xl border border-soft bg-surface hover:bg-surface-2"
      title="Notifications"
      aria-label="Notifications"
    >
      üîî
    </button>

    <!-- Profile -->
    <div class="relative">
      <button
        class="flex h-11 items-center gap-2 rounded-full border border-soft bg-surface px-2 pr-3 hover:bg-surface-2"
        (click)="toggleProfileDropdown()"
      >
        <img
          class="h-8 w-8 rounded-full border border-soft object-cover"
          src="https://i.pinimg.com/736x/0d/64/98/0d64989794b1a4c9d89bff571d3d5842.jpg"
          alt="profile"
        />
        <span class="hidden lg:block text-sm font-medium text-main max-w-[140px] truncate">
          {{ userName }}
        </span>
        <span class="text-faint">‚ñæ</span>
      </button>

      @if (isProfileOpen) {
        <div
          class="absolute right-0 mt-2 w-[220px] overflow-hidden rounded-2xl border border-primary bg-surface backdrop-blur-xl shadow-xl"
        >
          <button
            class="w-full flex items-center gap-2 px-3 py-2 text-sm text-main hover:bg-primary-soft"
          >
            üë§ <span>Profile</span>
          </button>

          <button
            class="w-full flex items-center gap-2 px-3 py-2 text-sm text-main hover:bg-primary-soft"
          >
            üßæ <span>Activity</span>
          </button>

          <div class="h-px bg-[color:var(--c-border)] my-1"></div>

          <button
            class="w-full flex items-center gap-2 px-3 py-2 text-sm text-danger hover:bg-primary-soft"
            (click)="logout()"
          >
            ‚éã <span>Logout</span>
          </button>
        </div>
      }
    </div>

    <!-- Language -->
    <div class="relative">
      <button
        class="flex h-11 items-center gap-2 rounded-full border border-soft bg-surface px-3 hover:bg-surface-2"
        (click)="toggleLangDropdown()"
      >
        <img [src]="selectedLang.flag" class="h-5 w-5 rounded-sm" alt="flag" />
        <span class="hidden lg:block text-sm text-muted">{{ selectedLang.code }}</span>
        <span class="text-faint">‚ñæ</span>
      </button>

      @if (isLangOpen) {
        <div
          class="absolute right-0 mt-2 w-[220px] overflow-hidden rounded-2xl border border-primary bg-surface backdrop-blur-xl shadow-xl"
        >
          @for (lang of languages; track lang.code) {
            <button
              class="w-full flex items-center gap-2 px-3 py-2 text-sm text-main hover:bg-primary-soft"
              (click)="selectLanguage(lang)"
            >
              <img [src]="lang.flag" class="h-4 w-6 rounded-sm object-cover" alt="lang" />
              <span class="flex-1 text-left">{{ lang.name }}</span>

              @if (selectedLang.code === lang.code) {
                <span class="text-success font-bold">‚úì</span>
              }
            </button>
          }
        </div>
      }
    </div>
  </div>
</header>
